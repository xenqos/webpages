<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Comprehensive Poker Outs Trainer</title>
</head>
<body>
  <h2>Poker Outs Trainer</h2>
  <div id="scenario"></div>
  <input type="number" id="userOuts" placeholder="Enter your outs">
  <button onclick="checkOuts()">Check</button>
  <p id="feedback"></p>
  <button onclick="newScenario()">New Scenario</button>

  <script>
    const suits = ['♠', '♥', '♦', '♣'];
    const ranks = ['2', '3', '4', '5', '6', '7', '8', '9', 'T', 'J', 'Q', 'K', 'A'];
    let playerHand = [];
    let flop = [];
    let correctOuts = 0;

    function getRandomCard(exclude = []) {
      let card;
      do {
        const rank = ranks[Math.floor(Math.random() * ranks.length)];
        const suit = suits[Math.floor(Math.random() * suits.length)];
        card = rank + suit;
      } while (exclude.includes(card));
      return card;
    }

    function getCardValue(card) {
      const valueMap = {'2':2, '3':3, '4':4, '5':5, '6':6, '7':7, '8':8, '9':9, 'T':10, 'J':11, 'Q':12, 'K':13, 'A':14};
      return valueMap[card[0]];
    }

    function newScenario() {
      let usedCards = [];
      playerHand = [getRandomCard(usedCards)];
      usedCards.push(playerHand[0]);
      playerHand.push(getRandomCard(usedCards));
      usedCards.push(playerHand[1]);

      flop = [];
      for (let i = 0; i < 3; i++) {
        const card = getRandomCard(usedCards);
        flop.push(card);
        usedCards.push(card);
      }

      correctOuts = 0;
      const allCards = [...playerHand, ...flop];

      // Flush draw
      const suitsCount = {};
      allCards.forEach(card => {
        const suit = card[1];
        suitsCount[suit] = (suitsCount[suit] || 0) + 1;
      });
      for (let suit in suitsCount) {
        if (suitsCount[suit] === 4) correctOuts += 9;
      }

      // Straight draws (OESD and Gutshot)
      const values = allCards.map(getCardValue).sort((a, b) => a - b);
      const uniqueVals = [...new Set(values)];
      for (let i = 0; i <= uniqueVals.length - 4; i++) {
        const seq = uniqueVals.slice(i, i + 4);
        if (seq[3] - seq[0] === 3) correctOuts += 8; // OESD
        else if (seq[3] - seq[0] === 4) correctOuts += 4; // Gutshot
      }

      // Overcards (assuming opponent has top pair or better)
      const boardVals = flop.map(getCardValue);
      const maxBoard = Math.max(...boardVals);
      const overcards = playerHand.filter(card => getCardValue(card) > maxBoard);
      correctOuts += overcards.length * 3; // 3 outs per overcard

      // Set to full house (1 card in hand matches flop pair)
      const rankCount = {};
      allCards.forEach(card => {
        const rank = card[0];
        rankCount[rank] = (rankCount[rank] || 0) + 1;
      });

      for (let rank in rankCount) {
        if (rankCount[rank] === 3 && playerHand.some(c => c[0] === rank)) {
          correctOuts += 7; // full house or quads
        }
      }

      // Two pair to full house
      let handRanks = playerHand.map(card => card[0]);
      let flopRanks = flop.map(card => card[0]);
      if (handRanks[0] !== handRanks[1] && flopRanks.includes(handRanks[0]) && flopRanks.includes(handRanks[1])) {
        correctOuts += 4; // full house from two pair
      }

      document.getElementById('scenario').innerText = `Your Hand: ${playerHand.join(' ')} | Flop: ${flop.join(' ')}

Count your outs.`;
      document.getElementById('feedback').innerText = '';
      document.getElementById('userOuts').value = '';
    }

    function checkOuts() {
      const userGuess = parseInt(document.getElementById('userOuts').value);
      if (userGuess === correctOuts) {
        document.getElementById('feedback').innerText = "✅ Correct!";
      } else {
        document.getElementById('feedback').innerText = `❌ Incorrect. The correct number of outs was ${correctOuts}.`;
      }
    }

    newScenario();
  </script>
</body>
</html>
